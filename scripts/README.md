# Email Processing Script

This script automatically signs up emails for Maven talks using browser automation. It includes SQLite database tracking to prevent duplicate submissions and supports dry-run mode for testing.

## Features

- **Database tracking**: Uses SQLite to track processed emails and prevent duplicates
- **Dry-run mode**: Test the script without actually submitting forms
- **Limit processing**: Process only a subset of emails for testing
- **Resume capability**: Can resume from where it left off if interrupted
- **Error tracking**: Records failures and error messages in the database

## Usage

### Basic Commands

```bash
# Dry run - test with first 3 emails (no actual submissions)
npm run stagehand -- --dry-run --test

# Dry run with custom limit
npm run stagehand -- --dry-run --limit 10

# Real run with first 3 emails
npm run stagehand -- --test

# Real run with custom limit
npm run stagehand -- --limit 50

# Process all emails (real run)
npm run stagehand

# Reset database (clear all processed records)
npm run stagehand -- --reset-db

# View current database stats
npm run stagehand -- --dry-run --limit 0
```

### Environment Variables

You can also use environment variables:

```bash
# Dry run mode
DRY_RUN=true npm run stagehand

# Set processing limit
LIMIT=25 npm run stagehand

# Set delay between requests (milliseconds)
DELAY_MS=3000 npm run stagehand
```

## How It Works

1. **Reads email data**: Loads emails from `missing_emails.jsonl` (generated by the Python script)
2. **Database check**: Checks if each email has already been processed successfully
3. **Browser automation**: Uses Stagehand to fill forms and submit (unless dry-run)
4. **Progress tracking**: Records success/failure in SQLite database
5. **Resume support**: Can be run multiple times safely - skips already processed emails

## Database Schema

The script creates `email_processing.db` with this table:

```sql
CREATE TABLE processed_emails (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  email TEXT NOT NULL,
  maven_url TEXT NOT NULL,
  talk_title TEXT NOT NULL,
  processed_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  success BOOLEAN NOT NULL,
  error_message TEXT,
  dry_run BOOLEAN DEFAULT FALSE,
  UNIQUE(email, maven_url)
);
```

## Recommended Workflow

1. **Test first**: `npm run stagehand -- --dry-run --test`
2. **Small batch**: `npm run stagehand -- --limit 10`
3. **Check results**: Look at console output and database stats
4. **Full run**: `npm run stagehand` (processes all remaining emails)

## Troubleshooting

- If the script fails, you can resume by running it again - it will skip processed emails
- Use `--reset-db` to clear the database and start over
- Check console output for detailed progress and error messages
- Database file is created in the same directory as the script 
---

IF you want to get discounts and 6 day email source on the topic make sure to subscribe to

<script async data-uid="010fd9b52b" src="https://fivesixseven.kit.com/010fd9b52b/index.js"></script>
